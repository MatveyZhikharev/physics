# Проект М1: Полет камня

## Условие задачи

> Камень бросают под углом к горизонту в земном поле тяжести с некоторой начальной скоростью. Составьте программу, которая численно решала бы дифференциальное уравнение движения камня, рассчитывая его траекторию движения и определяла бы точку падения. Исследуйте, как изменяется характер траектории при различных начальных параметрах броска (угол, начальная скорость, коэффициент сопротивления). Для силы сопротивления воздуха рассмотрите две модели:
>
> а) вязкое трение, пропорциональное скорости ($F \\sim v$)
>
> б) лобовое сопротивление, пропорциональное квадрату скорости ($F \\sim v^2$)

-----

## Решение

### Модель 1: Вязкое трение ($F \\sim v$) - Аналитическое решение

В этой модели предполагается, что сила сопротивления прямо пропорциональна скорости. Это позволяет найти точное аналитическое решение.

#### 1.1. Система дифференциальных уравнений

В основе решения лежит **второй закон Ньютона**. Раскладываем его на проекции на оси X и Y, учитывая силу тяжести $\\vec{F\_g} = (0, -mg)$ и силу вязкого трения $\\vec{F\_{сопр}} = -k\\vec{v} = (-kv\_x, -kv\_y)$:

```math
\begin{cases}
m\frac{dv_x}{dt} = -kv_x \\
m\frac{dv_y}{dt} = -mg - kv_y
\end{cases}
```

#### 1.2. Нахождение скоростей $v\_x(t)$ и $v\_y(t)$

Для упрощения вводим коэффициент $p = k/m$. Затем, методом **разделения переменных** и последующего интегрирования, получаем общие решения для скоростей с константами $C\_1$ и $C\_2$:

```math
\begin{cases}
\ln|v_x| = -pt + C_1 \\
\frac{1}{p}\ln|g + pv_y| = -t + C_2
\end{cases}
```

Используя начальные условия $v\_x(0) = v\_{0x}$ и $v\_y(0) = v\_{0y}$, находим константы. Итоговые уравнения для компонент скорости:

```math
\begin{cases}
v_x(t) = v_{0x} e^{-pt} \\
v_y(t) = \frac{(pv_{0y} + g)e^{-pt} - g}{p}
\end{cases}
```

#### 1.3. Нахождение координат $x(t)$ и $y(t)$

Интегрируя уравнения скоростей ($v = dx/dt$), получаем общие решения для координат с новыми константами $C\_3$ и $C\_4$:

```math
\begin{cases}
x(t) = -\frac{v_{0x}}{p}e^{-pt} + C_3 \\
y(t) = -\frac{pv_{0y} + g}{p^2}e^{-pt} - \frac{g}{p}t + C_4
\end{cases}
```

Применяем начальные условия положения $x(0) = x\_0$ и $y(0) = y\_0$, чтобы найти константы:

```math
C_3 = x_0 + \frac{v_{0x}}{p} \quad \text{и} \quad C_4 = y_0 + \frac{pv_{0y} + g}{p^2}
```

#### 1.4. Итоговые уравнения движения (Вязкое трение)

Подставляем найденные константы, а также исходные значения $p = k/m$, $v\_{0x} = v\_0 \\cos\\alpha$ и $v\_{0y} = v\_0 \\sin\\alpha$. Получаем финальные формулы, полностью описывающие траекторию:

```math
\begin{cases}
x(t) = \frac{mv_0\cos\alpha}{k}\left(1 - e^{-\frac{k}{m}t}\right) + x_0 \\
\\
y(t) = \left(\frac{m^2g + mkv_0\sin\alpha}{k^2}\right)\left(1 - e^{-\frac{k}{m}t}\right) - \frac{mg}{k}t + y_0
\end{cases}
```

-----

### Модель 2: Лобовое сопротивление ($F \\sim v^2$) - Численный подход

Эта модель более реалистична для высоких скоростей и не имеет простого аналитического решения.

#### 2.1. Система дифференциальных уравнений

Сила сопротивления направлена против вектора скорости, а её величина пропорциональна квадрату модуля скорости. Векторная форма силы:

```math
\vec{F}_{сопр} = -k|\vec{v}|\vec{v}
```

Раскладывая эту формулу на компоненты, где $|\\vec{v}| = \\sqrt{v\_x^2 + v\_y^2}$, получаем:

```math
\begin{cases}
F_{сопр_x} = -k v_x \sqrt{v_x^2 + v_y^2} \\
F_{сопр_y} = -k v_y \sqrt{v_x^2 + v_y^2}
\end{cases}
```

Итоговая система дифференциальных уравнений для второго закона Ньютона:

```math
\begin{cases}
m\frac{dv_x}{dt} = -k v_x \sqrt{v_x^2 + v_y^2} \\
\\
m\frac{dv_y}{dt} = -mg -k v_y \sqrt{v_x^2 + v_y^2}
\end{cases}
```

#### 2.2. Особенности системы и необходимость численного подхода

Данная система уравнений:

  * **Нелинейная**: Скорости входят в уравнение не в первой степени.
  * **Связанная**: Изменение скорости по одной оси зависит от скорости по другой оси.

Из-за этой сложности найти точную формулу траектории, как в первой модели, невозможно. Поэтому для решения этой задачи используются **численные методы**.

## Сверка аналитического и численного решений

Для проверки корректности выведенных аналитических формул (Модель 1) сравним их предсказания с результатами численного моделирования, полученными с помощью стандартного решателя ОДУ (`odeint` из библиотеки SciPy). Для Модели 2 (лобовое сопротивление) аналитического решения не существует, поэтому приводится только результат численного расчета.

**Методология:**
* **Численное решение** получается путем прямой интеграции системы дифференциальных уравнений, как это реализовано в предоставленном Python-коде.
* **Аналитическое решение** для дальности полета требует нахождения времени полета $t_{flight}$ путем численного решения уравнения $y(t_{flight}) = 0$. Затем это время подставляется в формулу для $x(t)$.

| Опыт № | Параметры (α, v₀, m, k) | Тип сопротивления | Аналитическое решение (дальность, м) | Численное решение (дальность, м) |
| :---: | :--- | :--- | :---: | :---: |
| 1 | 30°, 5 м/с, 2 кг, 5.0 | Вязкое ($F \sim v$) | **~1.15** | **1.15** |
| 2 | 30°, 5 м/с, 2 кг, 5.0 | Лобовое ($F \sim v^2$) | Неприменимо | **0.35** |
| 3 | 45°, 3 м/с, 2 кг, 1.5 | Вязкое ($F \sim v$) | **~0.75** | **0.75** |
| 4 | 80°, 9.5 м/с, 10 кг, 1.5 | Лобовое ($F \sim v^2$) | Неприменимо | **1.60** |

---
**Выводы по сверке:**

1.  Для случаев с **вязким трением** (Опыт №1 и №3) результаты, полученные из аналитических формул, полностью совпадают с результатами высокоточного численного моделирования. Это подтверждает корректность выведенных уравнений.
2.  Для случаев с **лобовым сопротивлением** (Опыт №2 и №4) аналитическое решение не существует. Приведены только результаты численного моделирования, которые демонстрируют значительно более сильное влияние этого типа сопротивления на дальность полета.
